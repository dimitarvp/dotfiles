source ~/.zsh/p10k.zsh
source ~/.zsh/ohmyzsh.zsh
source ~/.zsh/zsh.zsh # always put history opts after `oh-my-zsh` init or it will override this file.
source ~/.zsh/zplug.zsh
source ~/.zsh/fzy.zsh
source ~/.zsh/autocomplete.zsh
source ~/.zsh/aliases.zsh
source ~/.zsh/git.zsh
source ~/.zsh/gnu.zsh

source ~/.zsh/erlang.zsh
source ~/.zsh/elixir.zsh
source ~/.zsh/java.zsh
source ~/.zsh/golang.zsh
source ~/.zsh/rust.zsh
source ~/.zsh/ocaml.zsh
source ~/.zsh/ruby.zsh
source ~/.zsh/python.zsh

source ~/.zsh/paths.zsh
source ~/.zsh/package_managers.zsh

source ~/.zsh/fuzzy_finders/fzf.zsh
source ~/.zsh/fuzzy_finders/fzf_tab.zsh
source ~/.zsh/fuzzy_finders/peco.zsh
source ~/.zsh/fuzzy_finders/skim.zsh

# PSPG default command line options
export PSPG="--style 16 --force-uniborder --bold-labels --highlight-odd-rec --border 2 --no-sound"

# Tabulator shell scripts.
export PATH="$PATH:$HOME/bin/tabulator/bin"

# YTFZF: Specify cache directory.
YTFZF_CACHE=~/.cache/ytfzf

# YTFZF: Always choose best video and audio qualities.
export YTFZF_PREF="bestvideo[height<=?1080]+bestaudio/best"

# Decode JTW tokens on the command line.
jwtd() {
    if [[ -x $(command -v jq) ]]; then
        jq -R 'split(".") | .[0],.[1] | @base64d | fromjson' <<< "${1}"
        echo "Signature: $(echo "${1}" | awk -F'.' '{print $3}')"
    fi
}

# opam configuration
test -r /Users/dimi/.opam/opam-init/init.sh && . /Users/dimi/.opam/opam-init/init.sh > /dev/null 2> /dev/null || true

# direnv hook; must always be the last in the config.
eval "$(direnv hook zsh)"

. $HOME/.asdf/asdf.sh
. $HOME/.asdf/completions/asdf.bash

source /Users/dimi/Library/Preferences/org.dystroy.broot/launcher/bash/br

# Fuzzy `cd` finder
#. /usr/local/etc/profile.d/z.sh
#eval "$(zoxide init zsh)"

ulimit -n 98304

source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
source /usr/local/share/zsh-autosuggestions/zsh-autosuggestions.zsh

fpath+=${ZDOTDIR:-$HOME}/.zsh_functions

# Allow `parallel` to inherit environment variables from current shell.
#. `which env_parallel.zsh`

# Setup variables and scripts for local backup.
source $HOME/scripts/dimi_backup_setup

# Uncomment this to enable `fzf` completion when pressing TAB.
export ZSH_AUTOSUGGEST_STRATEGY=(history completion)

function lll {
  cd "$(llama "$@")"
}

# Enable Docker BuildKit.
export DOCKER_BUILDKIT=1

export NVIM_LSP_LOG=$HOME/.cache/nvim/lsp.log
export LVIM_LSP_LOG=$HOME/.cache/lvim/lsp.log

# Emacs-friendly LIBRARY_PATH
# NOTE: this does not help and that's why it's commented out. The symlink below does the job.
export LIBRARY_PATH=/usr/local/opt/gcc@12/lib/gcc/12:/usr/local/opt/libgccjit/lib/gcc/current:/usr/local/opt/gcc@12/lib/gcc/12/gcc/x86_64-apple-darwin21/12

# Also make sure to ALWAYS have this symlinked because Emacs expects the library `/usr/local/lib/libgccjit.0.dylib` to exist.
# sudo ln -s -v /usr/local/opt/libgccjit/lib/gcc/current/libgccjit.0.dylib /usr/local/lib/ 

source '/Users/dimi/Library/Application Support/org.dystroy.broot/launcher/bash/br'

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

# https://github.com/tversteeg/emplace
eval "$(emplace init zsh)"
